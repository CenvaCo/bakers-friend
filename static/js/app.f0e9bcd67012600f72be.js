webpackJsonp([1],{"1/oy":function(t,e){},"9M+g":function(t,e){},"E5/t":function(t,e){},GfHa:function(t,e){},Id91:function(t,e){},Jmt5:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n("7+uW"),i={name:"StoveItem",props:{store:Object},created:function(){},computed:{},methods:{dec:function(t){t.count--,0==t.count&&this.store.stoveOut(t)},inc:function(t){console.log(t),t.count++}}},a={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h5",[t._v("Печь")]),t._v(" "),n("b-row",t._l(t.store.state.stove,function(e){return n("b-col",{key:e.id,staticClass:" list-item"},[n("span",{staticClass:"text"},[t._v(t._s(e.recipe.name))]),t._v(" "),n("div",{staticClass:"controls"},[n("span",{staticClass:"dec",on:{click:function(n){t.dec(e)}}},[t._v("-")]),t._v(" "),n("b-badge",{staticClass:"counter",attrs:{variant:"primary",pill:""}},[t._v(t._s(e.count))]),t._v(" "),n("span",{staticClass:"inc",on:{click:function(n){t.inc(e)}}},[t._v("+")])],1)])}),1)],1)},staticRenderFns:[]};var r=n("VU/8")(i,a,!1,function(t){n("eDxF")},"data-v-2e279f98",null).exports,o={name:"Recipeslist",props:{store:Object,handler:Function},components:{},data:function(){return{}}},c={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-navbar",{attrs:{toggleable:"md",type:"dark",variant:"info"}},[n("b-navbar-toggle",{attrs:{target:"nav_collapse"}}),t._v(" "),n("b-navbar-brand",{attrs:{href:"#"}},[t._v("рецепты")]),t._v(" "),n("b-collapse",{attrs:{"is-nav":"",id:"nav_collapse"}},[n("b-navbar-nav",t._l(t.store.state.recipes,function(e){return n("b-nav-item",{key:e.id,attrs:{href:"#"}},[n("span",{on:{click:function(n){t.handler(e)}}},[t._v(t._s(e.name))])])}),1)],1)],1)],1)},staticRenderFns:[]},d=n("VU/8")(o,c,!1,null,null,null).exports,l={name:"ResultList",props:{store:Object},data:function(){return{ingredientsById:_.keyBy(this.store.state.ingredients,"id")}},computed:{fields:function(){return{id:{key:"id",label:"№"},name:{label:"Наименование"},count:{key:"count",label:"Количество"},quant:{label:"quant"},value:{label:"Всего"},unit:{label:""},store:{label:"Склад"}}},list:function(){let t=[];return this.store.state.stove.forEach(e=>{e.recipe.ingredients.forEach(n=>{const s=t.find(t=>t.id===n.id);if(s)s.count+=e.count;else{let s=this.store.state.ingredients.find(t=>t.id==n.id)||{};t.push({name:s.name,quant:n.quant,id:n.id,count:e.count,value:e.count*n.quant,unit:s.unit})}})}),t}}},u={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("h5",[this._v("Использованные инградиенты")]),this._v(" "),e("b-table",{attrs:{striped:"",hover:"",responsive:"",items:this.list,fields:this.fields}})],1)},staticRenderFns:[]},p=n("VU/8")(l,u,!1,null,null,null).exports,m=n("M4fF"),v=n.n(m),h={name:"RecipesEditor",props:{store:Object},components:{Recipeslist:d},data:function(){return{isHidden:!1,state:{name:"",ingredients:[]},selected:{},temp:{},ingredientsById:v.a.keyBy(this.store.state.ingredients,"id")}},computed:{isTempEmpty:function(){return v.a.isEmpty(this.temp)},recipes:function(){return this.temp.name?this.store.state.recipes.concat(this.temp):this.store.state.recipes},options:function(){let t=this.state.ingredients.map(t=>t.id);this.ingredientsById=v.a.keyBy(this.store.state.ingredients,"id");let e=this.store.state.ingredients.map(t=>({text:t.name,value:t.id})).filter(e=>!t.includes(e.value));return t.includes(this.temp.id)&&(this.temp={}),e}},methods:{select:function(t){this.state=t},addIngredient:function(){this.store.addRecipeIngr(this.state,this.temp)},removeIngradient:function(t){this.state.ingredients.splice(t,1)},addRecipe:function(){let t=parseInt(this.store.state.recipes.map(t=>t.id).sort().pop()),e={id:++t,name:"change me!",ingredients:[]};this.state=this.store.addRecipe(e)}}},f={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Recipeslist",{attrs:{store:t.store,handler:t.select}}),t._v(" "),n("b-row",[t.isHidden?t._e():n("b-col",[n("b-button",{on:{click:t.addRecipe}},[t._v("+")])],1),t._v(" "),n("b-col",{attrs:{cols:"12"}},[n("b-form-input",{model:{value:t.state.name,callback:function(e){t.$set(t.state,"name",e)},expression:"state.name"}}),t._v(" "),n("b-form-group",{staticClass:"mb-0",attrs:{label:"Ингредиенты",breakpoint:"lg","label-size":"lg","label-class":"font-weight-bold pt-0"}},t._l(t.state.ingredients,function(e,s){return n("div",{key:e.id,staticClass:"ingr-item"},[n("b-input-group",[n("b-btn",{attrs:{slot:"prepend"},on:{click:function(e){t.removeIngradient(s)}},slot:"prepend"},[t._v("-")]),t._v(" "),n("b-col",{attrs:{cols:"10"}},[t._v(t._s((t.ingredientsById[e.id]||{}).name))]),t._v(" "),n("b-form-input",{attrs:{cols:"2"},model:{value:e.quant,callback:function(n){t.$set(e,"quant",n)},expression:"ingr.quant"}}),t._v("\n            "+t._s((t.ingredientsById[e.id]||{}).unit)+"\n          ")],1)],1)}),0),t._v(" "),t.options.length&&this.state.name?n("b-input-group",{staticClass:"new-ingradient"},[t.isTempEmpty?t._e():n("b-btn",{attrs:{slot:"prepend"},on:{click:t.addIngredient},slot:"prepend"},[t._v("+")]),t._v(" "),n("b-col",{attrs:{cols:"10"}},[n("b-form-select",{attrs:{options:t.options},model:{value:t.temp.id,callback:function(e){t.$set(t.temp,"id",e)},expression:"temp.id"}})],1),t._v(" "),n("b-form-input",{model:{value:t.temp.quant,callback:function(e){t.$set(t.temp,"quant",e)},expression:"temp.quant"}})],1):t._e()],1)],1)],1)},staticRenderFns:[]};var b=n("VU/8")(h,f,!1,function(t){n("OAvV")},"data-v-fb4c00ae",null).exports;const g=new class{constructor(){this.recognizer=new webkitSpeechRecognition,this.recognizer.interimResults=!0,this.recognizer.lang="ru-Ru",this.recognizer.onresult=function(t){var e=t.results[t.resultIndex];e.isFinal?speechSynthesis.speak(new SpeechSynthesisUtterance(e[0].transcript)):console.log("Промежуточный результат: ",e[0].transcript)}}listen(){this.recognizer.start()}};var y={name:"IngredientsEditor",props:{store:Object},data:function(){return{state:{temp:{}}}},computed:{},methods:{listen:function(){console.log("listen"),g.listen()},remove:function(t){this.store.removeIngredient(t)},add:function(){let t=Object.assign({},this.state.temp);this.store.addIngredient(t)}},components:{}},k={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h5",[t._v("Ingredients Editor\n\n     "),n("b-btn",{attrs:{slot:"prepend"},on:{click:t.listen},slot:"prepend"},[t._v("listen")])],1),t._v(" "),n("b-row",[n("b-col",[t._l(t.store.state.ingredients,function(e){return n("div",{key:e.id,staticClass:"item"},[n("b-input-group",[n("b-btn",{attrs:{slot:"prepend"},on:{click:function(n){t.remove(e)}},slot:"prepend"},[t._v("-")]),t._v(" "),n("b-form-input",{model:{value:e.name,callback:function(n){t.$set(e,"name",n)},expression:"item.name"}}),t._v(" "),n("b-form-input",{model:{value:e.unit,callback:function(n){t.$set(e,"unit",n)},expression:"item.unit"}})],1)],1)}),t._v(" "),n("b-input-group",{staticClass:"add-section"},[n("b-btn",{attrs:{slot:"prepend"},on:{click:function(e){t.add()}},slot:"prepend"},[t._v("+")]),t._v(" "),n("b-form-input",{model:{value:t.state.temp.name,callback:function(e){t.$set(t.state.temp,"name",e)},expression:"state.temp.name"}}),t._v(" "),n("b-form-input",{model:{value:t.state.temp.unit,callback:function(e){t.$set(t.state.temp,"unit",e)},expression:"state.temp.unit"}})],1)],2)],1)],1)},staticRenderFns:[]};var I=n("VU/8")(y,k,!1,function(t){n("E5/t")},"data-v-1c635a2a",null).exports,R=n("xe4/");const w=new class{constructor(){let t=this.getBase64State();this.state=t||{experiments:[{id:0,parent:1,name:"experiment Whole grain Rye bread",ingredients:[{id:0,quant:2001},{parent:1,id:1,quant:3e3},{id:3,quant:500},{id:4,quant:80}]}],ingredients:[{id:0,name:"water",unit:"ml"},{id:1,name:"whole grain rye flour",unit:"gr"},{id:2,name:"whole grain wheat flour",unit:"gr"},{id:3,name:"Rye sour dough",unit:"gr"},{id:4,name:"Salt",unit:"gr"},{id:5,name:"Sugar",unit:"gr"}],stove:[],stock:[],recipes:[{id:0,name:"Whole grain Rye bread",ingredients:[{id:0,quant:2e3},{id:1,quant:3e3},{id:3,quant:500},{id:4,quant:80}]},{id:1,name:"Wheat bread",ingredients:[{id:0,quant:1500},{id:2,quant:3e3},{id:4,quant:50},{id:5,quant:150}]}]}}stoveIt(t){const e=this.state.stove.find(e=>e.recipe.name===t.name);e?e.count++:this.state.stove.push({count:1,recipe:t}),this.updateBase64Url()}stoveOut(t){const e=this.state.stove.indexOf(t);e>-1&&(this.state.stove.splice(e,1),this.updateBase64Url())}removeIngredient(t){let e=this.state.ingredients.indexOf(t);e>-1&&(this.state.ingredients.splice(e,1),this.updateBase64Url())}addRecipe(t){return this.state.recipes.push(t||{name:"empty",ingredients:[]}),this.updateBase64Url(),this.state.recipes[this.state.recipes.length-1]}addRecipeIngr(t,e){t.ingredients.push(Object.assign({},e)),this.updateBase64Url()}addIngredient(t){let e=parseInt(this.state.ingredients.map(t=>t.id).sort().pop());e++;let n=t?Object.assign({id:e},t):{id:e,name:"empty",ingredients:[]};this.state.ingredients.push(n),this.updateBase64Url()}getBase64State(){const t=window.location.hash.slice(1);if(t)try{const e=window.atob(t);return this.decode(e)||""}catch(t){console.error("hash parse:",t)}}updateBase64Url(){const t=this.encode(this.state);window.location.hash=window.btoa(t)}encode(t){return R.deflate(JSON.stringify(t),{to:"string"})}decode(t){return JSON.parse(R.inflate(t,{to:"string"}))}};var x={name:"app",components:{StoveItem:r,Recipeslist:d,RecipesEditor:b,IngredientsEditor:I,ResultList:p},data:function(){return{store:w}},methods:{stoveItProvider:function(t){this.store.stoveIt(t)}}},q={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("b-container",[n("b-tabs",[n("b-tab",{attrs:{title:"Boilerplate",active:""}},[n("b-row",[n("b-col",[n("Recipeslist",{attrs:{store:t.store,handler:t.stoveItProvider}})],1)],1),t._v(" "),n("b-row",[n("b-col",[n("StoveItem",{attrs:{store:t.store}}),t._v(" "),n("ResultList",{attrs:{store:t.store}})],1)],1)],1),t._v(" "),n("b-tab",{attrs:{title:"Рецептура"}},[n("RecipesEditor",{attrs:{store:t.store}})],1),t._v(" "),n("b-tab",{attrs:{title:"Склад",disabled:""}}),t._v(" "),n("b-tab",{attrs:{title:"Ингредиенты"}},[n("IngredientsEditor",{attrs:{store:t.store}})],1)],1)],1)],1)},staticRenderFns:[]};var E=n("VU/8")(x,q,!1,function(t){n("OrxP")},null,null).exports,O=n("e6fC");n("Jmt5"),n("9M+g");s.a.use(O.a),s.a.config.productionTip=!1,new s.a({render:t=>t(E)}).$mount("#app")},OAvV:function(t,e){},OrxP:function(t,e){},eDxF:function(t,e){},zj2Q:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.f0e9bcd67012600f72be.js.map